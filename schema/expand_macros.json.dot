{
  "id": "http://www.json-script.com/schema/expand_macros.json#",
  "$schema": "https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#",
  "title": "JSONScript macro expansion schema",
  "description": "Schema with custom keywords that expands macros in JSON script.",
  "switch": [{
    "if": { "type": "object" },
    "then": {
      "anyOf": [
        {{~ it.macros:macro }}
          {{~ macro.rules:rule }}
            {
              "expandJsMacro": {{= JSON.stringify(rule) }}
            },
          {{~}}
        {{~}}
        {
          "additionalProperties": { "$ref": "#" }
        }
      ]
    }
  }],
  "items": { "$ref": "#" }
}
